# LINE Stamp Maker GUI 要件定義書

## 1. 概要
`stamp_maker_banana` の各ツール（分割、背景透過、トリミング、整形）を統合し、直感的に操作できるGUIアプリケーションを作成する。

## 2. デザインコンセプト
- **フレームワーク**: `CustomTkinter` (モダンな外観)
- **テーマ**: ダークモード / ブルーアクセント
- **操作性**: ドラッグ＆ドロップ (D&D) 対応、ワンクリック実行

## 3. 機能要件

### A. 入力エリア
- **フォルダ選択**:
    - テキストボックスによるパス表示
    - 「参照...」ボタンでのダイアログ選択
    - **ドラッグ＆ドロップ (D&D)**: フォルダをウィンドウにドロップして入力パスを設定
- **入力ソース**:
    - **フォルダ指定のみ**:
        - テキストボックス、参照ボタン、またはドラッグ＆ドロップ (D&D) で指定したフォルダを処理対象とする。
        - ※プロジェクト内の `input` フォルダを選択する機能は不要。

### B. 処理パイプライン選択 (チェックボックス)
一連の処理をどこからどこまで行うかを選択可能にする。

1.  ☑ **分割 (Splitter v2)**
    - **オプション**:
        - グリッド: [Auto] / [4x2] / [3x3] / [4x4] (コンボボックス)
        - 許容値 (Tolerance): スライダー (0-100)
        - フチ除去 (Erosion): スライダー (0-5)
2.  ☑ **背景透過 (BG Remover)**
    - *※分割ツールですでに透過されている場合はスキップ可能*
    - モード: [Flood] / [Auto Color] / [Color Key]
3.  ☑ **トリミング (Auto Trimmer)**
    - 余白 (Padding): 数値入力 (px)
4.  ☑ **スタンプ整形 (Formatter)**
    - *※未実装機能（これから実装）*
    - 370x320px へのリサイズと配置
    - main/tab画像の生成

### C. 実行エリア
- **「処理開始」ボタン**: 選択された処理を一括実行
- **ログ表示エリア**: 実行ログ、進捗状況をリアルタイム表示
- **プログレスバー**: 全体の進捗を表示

## 4. 画面レイアウト案

```
+---------------------------------------------------------------+
|  LINE Stamp Maker Banana                                  [-] |
+---------------------------------------------------------------+
|                                                               |
|  [ 入力設定 ]-----------------------------------------------  |
|  (o) カスタムフォルダ    ( ) 標準inputフォルダ                |
|  [ C:\Users\...\Desktop\images                     ] [参照]   |
|  ★ ここにフォルダをドラッグ＆ドロップ可能 ★                   |
|                                                               |
|  [ 処理設定 ]-----------------------------------------------  |
|  [v] 1. スタンプ分割 (Splitter)                               |
|      Grid: [ Auto v ]  Tolerance: [ 50 ]  Erosion: [ 1 ]      |
|                                                               |
|  [ ] 2. 背景透過 (BG Remover)  (分割時は不要ならOFF)          |
|      Mode: [ Flood v ]                                        |
|                                                               |
|  [v] 3. トリミング (Auto Trimmer)                             |
|      Padding: [ 10 ] px                                       |
|                                                               |
|  [v] 4. スタンプ整形 (Formatter)                              |
|      Output: [ output_final ]                                 |
|                                                               |
|  -----------------------------------------------------------  |
|                                                               |
|  [       一括処理を実行 (RUN)       ]                         |
|                                                               |
|  [ ログ出力エリア --------------------------------------- ]   |
|  | Processing image 1/8... Done.                          |   |
|  | Trimming... Done.                                      |   |
|  [--------------------------------------------------------]   |
|  [================== 50% ==================      ]            |
|                                                               |
+---------------------------------------------------------------+
```

## 5. 技術スタック
- Python 3.10+
- `customtkinter`: UIフレームワーク
- `tkinterdnd2`: ドラッグ＆ドロップ対応
- `Pillow`, `opencv-python-headless`: 画像処理
- `threading`: UIをフリーズさせずに処理を実行するために使用

## 6. 実装ステップ
1.  `line_stamp_formatter.py` の実装（まだ完了していないため）
2.  `gui.py` のプロトタイプ作成（外観のみ）
3.  各ツール（`stamp_splitter_v2.py` 等）をモジュールとしてインポートできるようにリファクタリング（`main` 関数分離など）
4.  GUIとロジックの結合
5.  D&D機能の実装
